# 《重构，改善既有代码的设计》

## 第1章 重构，第一个案例

### 1.2

* 重构之前，首先检查自己是否有一套可靠的测试机制。这些测试必须有自我检验能力。

### 1.3

* 第一个步骤是找出代码的逻辑泥团并运用到 **Extract Method**。首先，得找出函数内的 **局部变量和参数**。任何 **不会** 被修改的变量都可以 **当成参数传入新的函数**。会被修改的变量需要格外小心，如果只有一个变量被修改，可以把它 **当作返回值**。

* 一些临时变量的使用，可以改成使用查询函数来进行，虽然这样可能带来性能上的代价，需要根据实际情况取舍。

### 1.4

* 最好不要在另一个对象的属性基础上运用 `switch` 语句，如果不得不使用，也应该在对象自己的数据上用。

## 第2章 重构原则

### 2.1

* 重构(名词)：对软件内部结构的一种调整，目的是在不改变软件可观察行为的前提下，提高其可理解性，降低其修改成本。

* 重构(动词)：使用一系列重构手法，在不改变软件可观察行为的前提下，调整其结构。

### 2.3

* 事不过三，三则重构

### 2.4

间接层的作用:

1. 允许逻辑共享。

2. 分开解释意图和实现。

3. 隔离变化。

4. 封装条件逻辑。

## 第3章 代码的坏味道

### 3.1 Duplicated Code(重复代码)

1. 最简单的就是同一个类的两个函数有相同表达式，这时候可以用 **Extract Method** 提炼出重复的代码，然后让这两个地点都调用提炼出来的那一段代码。

2. 两个互为兄弟的子类内含相同表达式，对两个类都使用 **Extract Method** ，然后对提炼出来的代码使用 **Pull Up Method**， 将它推入超类内。 
3. 如果两个毫不相关的类出现 **Duplicated Code** ，应该考虑把重复代码提炼到其中一个类或者第三个类。

### 3.2 Long Method(过长函数)

* 每当感觉需要以注释来说明点什么的时候，就把需要说明的东西写进一个独立的函数内，并以其 **用途** (并非实现手法)命名。只要函数名称能解释其用途，应该毫不犹豫的这么做。关键不在于函数的长度，而在于函数“做什么”和“如何做”之间的语义距离。


